<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Logga in – BetSpread</title>
<style>
  :root { font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }
  body { margin:0; background:#0b1116; color:#e7eef5; }
  a { color:#93c5fd; text-decoration:none }
  .center { min-height:100svh; display:grid; place-items:center; padding:24px; }
  .card { width:min(560px, 92vw); background:#0f1720; border:1px solid #1f2a37; border-radius:16px; padding:24px; box-shadow:0 10px 30px rgba(0,0,0,.25); }
  h1 { margin:0 0 6px; font-size:22px; }
  p.muted { margin:0 0 16px; color:#94a3b8; }
  label { font-size:12px; color:#b6c2cf; display:block; margin:14px 0 6px; }
  input { width:100%; padding:12px; border-radius:10px; border:1px solid #243244; background:#0b1320; color:#e7eef5; }
  .row { display:flex; gap:10px; flex-wrap:wrap; margin-top:16px; }
  .btn{padding:12px 14px;border-radius:10px;border:0;font-weight:700;cursor:pointer}
  .btn-ghost{ background:transparent; border:1px solid #334155;color:#e7eef5 }
  .hidden{display:none}
  .err{margin-top:8px;color:#fecaca;background:#3b0a0a;border:1px solid #6b1212;padding:10px 12px;border-radius:10px}
  .ok{margin-top:8px;color:#bbf7d0;background:#083d24;border:1px solid #195a39;padding:10px 12px;border-radius:10px}
</style>
</head>
<body>
<div class="center">
  <div class="card">
    <h1>BetSpread</h1>
    <p class="muted">Logga in eller skapa konto för att komma åt tjänsten.</p>

    <div style="display:flex;gap:16px;flex-wrap:wrap;margin-bottom:12px">
      <button id="tabLogin" class="btn">Logga in</button>
      <button id="tabSignup" class="btn-ghost">Skapa konto</button>
    </div>

    <div id="loginForm">
      <label for="loginEmail">E-post</label>
      <input id="loginEmail" type="email" placeholder="din@mail.se" autocomplete="email" />
      <label for="loginPassword">Lösenord</label>
      <input id="loginPassword" type="password" placeholder="••••••••" autocomplete="current-password" />
      <div class="row"><button id="loginBtn" class="btn">Logga in</button></div>
      <div id="loginErr" class="err" style="display:none"></div>
    </div>

    <div id="signupForm" class="hidden">
      <label for="signupEmail">E-post</label>
      <input id="signupEmail" type="email" placeholder="din@mail.se" autocomplete="email" />
      <label for="signupPassword">Lösenord</label>
      <input id="signupPassword" type="password" placeholder="Minst 6 tecken" autocomplete="new-password" />
      <div class="row"><button id="signupBtn" class="btn">Skapa konto</button></div>
      <div id="signupInfo" class="ok" style="display:none"></div>
      <div id="signupErr" class="err" style="display:none"></div>
    </div>

    <div class="row" style="margin-top:10px">
      <a href="index.html" class="btn-ghost" style="padding:8px 12px;border-radius:10px">Till landningssidan</a>
    </div>
  </div>
</div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
  const SUPABASE_URL = "https://updpywjfxeahtjpelbku.supabase.co";
  const SUPABASE_KEY = "sb_publishable_GB6f7XXePLTeIVIJYGjODg_rRlKqi4B";
  const SB = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  // Om redan inloggad → till app
  SB.auth.getSession().then(({data})=>{
    if(data.session?.user){ window.location.replace('app.html'); }
  });

  // Växla flikar
  const $ = (id)=>document.getElementById(id);
  $('tabLogin').onclick = ()=>{ $('loginForm').classList.remove('hidden'); $('signupForm').classList.add('hidden'); };
  $('tabSignup').onclick = ()=>{ $('signupForm').classList.remove('hidden'); $('loginForm').classList.add('hidden'); };

  // Login
  $('loginBtn').onclick = async ()=>{
    $('loginErr').style.display='none';
    const email = $('loginEmail').value.trim();
    const password = $('loginPassword').value;
    if(!email || !password){ $('loginErr').textContent='Fyll i e-post och lösenord.'; $('loginErr').style.display='block'; return; }
    const { error } = await SB.auth.signInWithPassword({ email, password });
    if(error){ $('loginErr').textContent=error.message; $('loginErr').style.display='block'; return; }
    window.location.replace('app.html');
  };

  // Sign up
  $('signupBtn').onclick = async ()=>{
    $('signupErr').style.display='none'; $('signupInfo').style.display='none';
    const email = $('signupEmail').value.trim();
    const password = $('signupPassword').value;
    if(!email || !password){ $('signupErr').textContent='Fyll i e-post och lösenord.'; $('signupErr').style.display='block'; return; }
    const { error } = await SB.auth.signUp({ email, password, options:{ emailRedirectTo: window.location.origin + '/app.html' } });
    if(error){ $('signupErr').textContent=error.message; $('signupErr').style.display='block'; return; }
    $('signupInfo').textContent='Konto skapat. Du kan nu logga in.'; $('signupInfo').style.display='block';
  };
</script>
</body>
</html>
